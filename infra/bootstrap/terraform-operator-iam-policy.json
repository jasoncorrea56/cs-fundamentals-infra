{
	"Version": "2012-10-17",
	"Statement": [
		{
			"Effect": "Allow",
			"Action": [
				"s3:CreateBucket",
				"s3:DeleteBucket",
				"s3:ListBucket",
				"s3:GetBucket*",
				"s3:PutBucket*",
				"s3:GetEncryptionConfiguration",
				"s3:PutEncryptionConfiguration",
				"s3:GetObject",
				"s3:PutObject",
				"s3:DeleteObject",
				"s3:GetAccelerateConfiguration",
				"s3:GetLifecycleConfiguration",
				"s3:GetReplicationConfiguration",
				"s3:DeleteBucketPolicy",
				"dynamodb:CreateTable",
				"dynamodb:UpdateTable",
				"dynamodb:DeleteTable",
				"dynamodb:Describe*",
				"dynamodb:GetItem",
				"dynamodb:PutItem",
				"dynamodb:DeleteItem",
				"dynamodb:UpdateItem",
				"dynamodb:TagResource",
				"dynamodb:ListTagsOfResource",
				"ecr:CreateRepository",
				"ecr:DescribeRepositories",
				"ecr:DeleteLifecyclePolicy",
				"ecr:GetLifecyclePolicy",
				"ecr:PutLifecyclePolicy",
				"ecr:PutImageScanningConfiguration",
				"ecr:SetRepositoryPolicy",
				"ecr:GetRepositoryPolicy",
				"ecr:TagResource",
				"ecr:ListTagsForResource",
				"ecr:DescribeImages",
				"ecr:ListImages",
				"ecr:PutImage",
				"ecr:GetAuthorizationToken",
				"ecr:BatchCheckLayerAvailability",
				"ecr:BatchGetImage",
				"ecr:CompleteLayerUpload",
				"ecr:InitiateLayerUpload",
				"ecr:UploadLayerPart",
				"ecr:GetDownloadUrlForLayer",
				"ecr:DeleteRepository",
				"ec2:CreateVpc",
				"ec2:DeleteVpc",
				"ec2:ModifyVpcAttribute",
				"ec2:Describe*",
				"ec2:CreateSubnet",
				"ec2:DeleteSubnet",
				"ec2:ModifySubnetAttribute",
				"ec2:CreateInternetGateway",
				"ec2:DeleteInternetGateway",
				"ec2:AttachInternetGateway",
				"ec2:DetachInternetGateway",
				"ec2:CreateRouteTable",
				"ec2:DeleteRouteTable",
				"ec2:AssociateRouteTable",
				"ec2:DisassociateRouteTable",
				"ec2:CreateRoute",
				"ec2:ReplaceRoute",
				"ec2:DeleteRoute",
				"ec2:AllocateAddress",
				"ec2:ReleaseAddress",
				"ec2:CreateNatGateway",
				"ec2:DeleteNatGateway",
				"ec2:CreateTags",
				"ec2:DeleteTags",
				"ec2:DisassociateAddress",
				"ec2:CreateSecurityGroup",
				"ec2:RevokeSecurityGroupEgress",
				"ec2:DeleteSecurityGroup",
				"ec2:AuthorizeSecurityGroupIngress",
				"ec2:AuthorizeSecurityGroupEgress",
				"ec2:RevokeSecurityGroupIngress",
				"route53:CreateHostedZone",
				"route53:GetHostedZone",
				"route53:ListHostedZones",
				"route53:ListHostedZonesByName",
				"route53:ChangeResourceRecordSets",
				"route53:ListResourceRecordSets",
				"route53:GetChange",
				"route53:GetDNSSEC",
				"route53:DeleteHostedZone",
				"route53:ListTagsForResource",
				"acm:RequestCertificate",
				"acm:DescribeCertificate",
				"acm:ListCertificates",
				"acm:DeleteCertificate",
				"acm:AddTagsToCertificate",
				"acm:ListTagsForCertificate",
				"eks:CreateCluster",
				"eks:DeleteCluster",
				"eks:DescribeCluster",
				"eks:ListClusters",
				"eks:UpdateClusterConfig",
				"eks:UpdateClusterVersion",
				"eks:DescribeUpdate",
				"eks:TagResource",
				"eks:UntagResource",
				"eks:CreateNodegroup",
				"eks:DeleteNodegroup",
				"eks:DescribeNodegroup",
				"eks:ListNodegroups",
				"eks:UpdateNodegroupConfig",
				"eks:UpdateNodegroupVersion",
				"eks:DescribeAddonVersions",
				"elasticloadbalancing:DescribeLoadBalancers",
				"elasticloadbalancing:DescribeLoadBalancerAttributes",
				"elasticloadbalancing:DescribeTags",
				"elasticloadbalancing:DescribeTargetHealth",
				"elasticloadbalancing:DeleteLoadBalancer",
				"iam:CreateRole",
				"iam:DeleteRole",
				"iam:GetRole",
				"iam:PassRole",
				"iam:TagRole",
				"iam:ListRoles",
				"iam:CreatePolicy",
				"iam:DeletePolicy",
				"iam:GetPolicy",
				"iam:TagPolicy",
				"iam:CreatePolicyVersion",
				"iam:DeletePolicyVersion",
				"iam:GetPolicyVersion",
				"iam:AttachRolePolicy",
				"iam:DetachRolePolicy",
				"iam:DeleteRolePolicy",
				"iam:GetRolePolicy",
				"iam:PutRolePolicy",
				"iam:ListRolePolicies",
				"iam:ListPolicyVersions",
				"iam:ListAttachedRolePolicies",
				"iam:CreateInstanceProfile",
				"iam:DeleteInstanceProfile",
				"iam:AddRoleToInstanceProfile",
				"iam:ListInstanceProfilesForRole",
				"iam:CreateOpenIDConnectProvider",
				"iam:DeleteOpenIDConnectProvider",
				"iam:GetOpenIDConnectProvider",
				"iam:ListOpenIDConnectProviders",
				"iam:UpdateOpenIDConnectProviderThumbprint",
				"iam:UpdateAssumeRolePolicy",
				"logs:DescribeLogGroups",
				"logs:DescribeLogStreams",
				"logs:ListTagsForResource",
				"logs:PutRetentionPolicy",
				"logs:CreateLogGroup",
				"logs:DeleteLogGroup",
				"cloudwatch:DescribeAlarms",
				"cloudwatch:ListTagsForResource",
				"cloudwatch:PutMetricAlarm",
				"cloudwatch:DeleteAlarms",
				"cloudwatch:TagResource",
				"SNS:CreateTopic",
				"SNS:SetTopicAttributes",
				"SNS:GetTopicAttributes",
				"SNS:ListTagsForResource",
				"SNS:DeleteTopic",
				"SNS:Subscribe",
				"SNS:Unsubscribe",
				"SNS:GetSubscriptionAttributes",
				"secretsmanager:ListSecrets",
				"route53:ChangeTagsForResource",
				"route53:ListTagsForResource"
			],
			"Resource": "*"
		},
		{
			"Effect": "Allow",
			"Action": "iam:CreateServiceLinkedRole",
			"Resource": "*",
			"Condition": {
				"StringEquals": {
					"iam:AWSServiceName": [
						"eks.amazonaws.com",
						"eks-nodegroup.amazonaws.com",
						"autoscaling.amazonaws.com"
					]
				}
			}
		},
		{
			"Effect": "Allow",
			"Action": [
				"eks:CreateAddon",
				"eks:ListAddons",
				"eks:DescribeCluster"
			],
			"Resource": "arn:aws:eks:us-west-2:948319129176:cluster/csf-*"
		},
		{
			"Effect": "Allow",
			"Action": [
				"eks:DescribeAddon",
				"eks:UpdateAddon",
				"eks:DeleteAddon",
				"eks:DescribeUpdate",
				"eks:ListTagsForResource"
			],
			"Resource": "arn:aws:eks:us-west-2:948319129176:addon/csf-*/*"
		},
		{
			"Effect": "Allow",
			"Action": [
				"secretsmanager:CreateSecret",
				"secretsmanager:DeleteSecret",
				"secretsmanager:DescribeSecret",
				"secretsmanager:GetSecretValue",
				"secretsmanager:ListSecrets",
				"secretsmanager:PutSecretValue",
				"secretsmanager:RestoreSecret",
				"secretsmanager:UpdateSecret",
				"secretsmanager:GetResourcePolicy",
				"secretsmanager:TagResource"
			],
			"Resource": "arn:aws:secretsmanager:us-west-2:948319129176:secret:csf/*/db-url-*"
		},
		{
			"Effect": "Allow",
			"Action": [
				"logs:CreateLogGroup",
				"logs:PutRetentionPolicy",
				"logs:ListTagsForResource",
				"logs:TagLogGroup",
				"logs:DescribeLogGroups",
				"logs:DeleteLogGroup"
			],
			"Resource": "arn:aws:logs:us-west-2:948319129176:log-group:/aws/containerinsights/*:*"
		},
		{
			"Effect": "Allow",
			"Action": [
				"logs:ListTagsForResource"
			],
			"Resource": "arn:aws:logs:us-west-2:948319129176:log-group:/aws/containerinsights/*"
		},
		{
			"Effect": "Allow",
			"Action": [
				"iam:GetRolePolicy"
			],
			"Resource": [
				"arn:aws:iam::948319129176:role/csf-cloudwatch-agent-role",
				"arn:aws:iam::948319129176:role/csf-fluent-bit-role"
			]
		},
		{
			"Effect": "Allow",
			"Action": [
				"secretsmanager:CreateSecret",
				"secretsmanager:DeleteSecret",
				"secretsmanager:DescribeSecret",
				"secretsmanager:GetResourcePolicy",
				"secretsmanager:GetSecretValue",
				"secretsmanager:PutSecretValue",
				"secretsmanager:RestoreSecret"
			],
			"Resource": [
				"arn:aws:secretsmanager:us-west-2:948319129176:secret:csf/*"
			]
		}
	]
}
